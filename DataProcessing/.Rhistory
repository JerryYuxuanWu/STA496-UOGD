monthly_gas = sum(monthly_gas, na.rm=T))
wells_prod %>%
group_by(prod_date, type) %>%
filter(prod_date >='2023-05-01',
prod_date <='2024-06-01') %>%
summarize(monthly_oil = sum(monthly_oil, na.rm=T),
monthly_gas = sum(monthly_gas, na.rm=T))
wells_prod %>%
group_by(prod_date, type) %>%
filter(prod_date >='2023-05-01',
prod_date <='2024-06-01') %>%
summarize(monthly_oil = sum(monthly_oil, na.rm=T),
monthly_gas = sum(monthly_gas, na.rm=T)) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional'))
wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date, type) %>%
filter(prod_date >='2023-05-01',
prod_date <='2024-06-01') %>%
summarize(monthly_oil_10km = sum(monthly_oil, na.rm=T),
monthly_gas_10km = sum(monthly_gas, na.rm=T)) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional'))
left_join(a, b)
a <- wells_prod %>%
group_by(prod_date, type) %>%
filter(prod_date >='2023-05-01',
prod_date <='2024-06-01') %>%
summarize(monthly_oil = sum(monthly_oil, na.rm=T),
monthly_gas = sum(monthly_gas, na.rm=T)) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional'))
b <- wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date, type) %>%
filter(prod_date >='2023-05-01',
prod_date <='2024-06-01') %>%
summarize(monthly_oil_10km = sum(monthly_oil, na.rm=T),
monthly_gas_10km = sum(monthly_gas, na.rm=T)) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional'))
left_join(a, b)
wells_prod %>%
group_by(prod_date, type) %>%
filter(prod_date >='2023-05-01',
prod_date <='2024-06-01') %>%
summarize(monthly_oil = sum(monthly_oil, na.rm=T),
monthly_gas = sum(monthly_gas, na.rm=T)) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional'))
a <- wells_prod %>%
group_by(prod_date, type) %>%
filter(prod_date >='2023-05-01',
prod_date <='2024-06-01') %>%
summarize(monthly_oil = sum(monthly_oil, na.rm=T),
monthly_gas = sum(monthly_gas, na.rm=T)) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional')) %>%
bind_rows(wells_prod %>%
group_by(prod_date) %>%
filter(prod_date >='2023-05-01',
prod_date <='2024-06-01') %>%
summarize(monthly_oil = sum(monthly_oil, na.rm=T),
monthly_gas = sum(monthly_gas, na.rm=T)) %>%
mutate(type = 'Total'))
a
left_join(a, b) %>% arrange(prod_date)
a <- wells_prod %>%
group_by(prod_date, type) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional')) %>%
bind_rows(
wells_prod %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = 'Total')
)
b <- wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date, type) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil_10km = sum(monthly_oil, na.rm = T),
monthly_gas_10km = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional')) %>%
bind_rows(
wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = 'Total')
)
left_join(a, b) %>% arrange(prod_date)
wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = 'Total')
a <- wells_prod %>%
group_by(prod_date, type) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional')) %>%
bind_rows(
wells_prod %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = 'Total')
)
b <- wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date, type) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil_10km = sum(monthly_oil, na.rm = T),
monthly_gas_10km = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional')) %>%
bind_rows(
wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil_10km = sum(monthly_oil, na.rm = T),
monthly_gas_10km = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = 'Total')
)
left_join(a, b) %>% arrange(prod_date)
total <- bind_cols(
wells_prod %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = 'Total')
,
wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil_10km = sum(monthly_oil, na.rm = T),
monthly_gas_10km = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = 'Total')
)
total
total <- left_join(
wells_prod %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = 'Total')
,
wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil_10km = sum(monthly_oil, na.rm = T),
monthly_gas_10km = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = 'Total')
)
total
total <- left_join(
wells_prod %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
)
,
wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil_10km = sum(monthly_oil, na.rm = T),
monthly_gas_10km = sum(monthly_gas, na.rm = T)
)
) %>%
mutate(type = 'Total')
total
total
total <- left_join(
wells_prod %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
)
,
wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil_10km = sum(monthly_oil, na.rm = T),
monthly_gas_10km = sum(monthly_gas, na.rm = T)
)
) %>%
mutate(type = 'Total') %>%
relocate(prod_date, type)
total
c <- left_join(a, b) %>%
left_join(total, suffix = c("", "_total"))
c
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total"))
c
?stringr
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_total_10km*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_total_10km*100, 2))
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_total_10km*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_total_10km*100, 2))
left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total"))
left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2))
mutate(monthly_oil = str_glue("{monthly_oil} ({oil_percent}%)"),
monthly_gas = str_glue("{monthly_gas} ({gas_percent}%)"),
monthly_oil_10km = str_glue("{monthly_oil_10km} ({oil_percent_10km}%)"),
monthly_gas_10km = str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = str_glue("{monthly_oil} ({oil_percent}%)"),
monthly_gas = str_glue("{monthly_gas} ({gas_percent}%)"),
monthly_oil_10km = str_glue("{monthly_oil_10km} ({oil_percent_10km}%)"),
monthly_gas_10km = str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))
c
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = str_glue("{monthly_oil} ({oil_percent}%)"),
monthly_gas = str_glue("{monthly_gas} ({gas_percent}%)"),
monthly_oil_10km = str_glue("{monthly_oil_10km} ({oil_percent_10km}%)"),
monthly_gas_10km = str_glue("{monthly_gas_10km} ({gas_percent_10km}%)")) %>%
select(-ends_with("_total")) %>%
bind_rows(total) %>%
arrange(prod_date)
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = str_glue("{monthly_oil} ({oil_percent}%)"),
monthly_gas = str_glue("{monthly_gas} ({gas_percent}%)"),
monthly_oil_10km = str_glue("{monthly_oil_10km} ({oil_percent_10km}%)"),
monthly_gas_10km = str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))
c
left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = str_glue("{monthly_oil} ({oil_percent}%)"),
monthly_gas = str_glue("{monthly_gas} ({gas_percent}%)"),
monthly_oil_10km = str_glue("{monthly_oil_10km} ({oil_percent_10km}%)"),
monthly_gas_10km = str_glue("{monthly_gas_10km} ({gas_percent_10km}%)")) %>%
select(-ends_with("_total"))
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = str_glue("{monthly_oil} ({oil_percent}%)"),
monthly_gas = str_glue("{monthly_gas} ({gas_percent}%)"),
monthly_oil_10km = str_glue("{monthly_oil_10km} ({oil_percent_10km}%)"),
monthly_gas_10km = str_glue("{monthly_gas_10km} ({gas_percent_10km}%)")) %>%
select(-ends_with("_total"), -str_detect('_percent')) %>%
bind_rows(total) %>%
arrange(prod_date)
?select
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = str_glue("{monthly_oil} ({oil_percent}%)"),
monthly_gas = str_glue("{monthly_gas} ({gas_percent}%)"),
monthly_oil_10km = str_glue("{monthly_oil_10km} ({oil_percent_10km}%)"),
monthly_gas_10km = str_glue("{monthly_gas_10km} ({gas_percent_10km}%)")) %>%
select(-ends_with("_total"), -contains('_percent')) %>%
bind_rows(total) %>%
arrange(prod_date)
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = str_glue("{monthly_oil} ({oil_percent}%)"),
monthly_gas = str_glue("{monthly_gas} ({gas_percent}%)"),
monthly_oil_10km = str_glue("{monthly_oil_10km} ({oil_percent_10km}%)"),
monthly_gas_10km = str_glue("{monthly_gas_10km} ({gas_percent_10km}%)")) %>%
select(-ends_with("_total"), -contains('_percent'))
c
total
?bind_rows
?str_glue
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = as.character(str_glue("{monthly_oil} ({oil_percent}%)")),
monthly_gas = as.character(str_glue("{monthly_gas} ({gas_percent}%)")),
monthly_oil_10km = as.character(str_glue("{monthly_oil_10km} ({oil_percent_10km}%)")),
monthly_gas_10km = as.character(str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))) %>%
select(-ends_with("_total"), -contains('_percent')) %>%
bind_rows(total) %>%
arrange(prod_date)
left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = as.character(str_glue("{monthly_oil} ({oil_percent}%)")),
monthly_gas = as.character(str_glue("{monthly_gas} ({gas_percent}%)")),
monthly_oil_10km = as.character(str_glue("{monthly_oil_10km} ({oil_percent_10km}%)")),
monthly_gas_10km = as.character(str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))) %>%
select(-ends_with("_total"), -contains('_percent'))
left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = as.character(str_glue("{monthly_oil} ({oil_percent}%)")),
monthly_gas = as.character(str_glue("{monthly_gas} ({gas_percent}%)")),
monthly_oil_10km = as.character(str_glue("{monthly_oil_10km} ({oil_percent_10km}%)")),
monthly_gas_10km = as.character(str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))) %>%
select(-ends_with("_total"), -contains('_percent')) %>%
bind_rows(total)
left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = as.character(str_glue("{monthly_oil} ({oil_percent}%)")),
monthly_gas = as.character(str_glue("{monthly_gas} ({gas_percent}%)")),
monthly_oil_10km = as.character(str_glue("{monthly_oil_10km} ({oil_percent_10km}%)")),
monthly_gas_10km = as.character(str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))) %>%
select(-ends_with("_total"), -contains('_percent'))
total
?bind_rows
?mutate_al
?mutate_at
?mutate
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = as.character(str_glue("{monthly_oil} ({oil_percent}%)")),
monthly_gas = as.character(str_glue("{monthly_gas} ({gas_percent}%)")),
monthly_oil_10km = as.character(str_glue("{monthly_oil_10km} ({oil_percent_10km}%)")),
monthly_gas_10km = as.character(str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))) %>%
select(-ends_with("_total"), -contains('_percent')) %>%
bind_rows(total %>% mutate(across(contains('monthly'), as.character()))) %>%
arrange(prod_date)
arrange(prod_date)
arrange(prod_date)
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = as.character(str_glue("{monthly_oil} ({oil_percent}%)")),
monthly_gas = as.character(str_glue("{monthly_gas} ({gas_percent}%)")),
monthly_oil_10km = as.character(str_glue("{monthly_oil_10km} ({oil_percent_10km}%)")),
monthly_gas_10km = as.character(str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))) %>%
select(-ends_with("_total"), -contains('_percent')) %>%
bind_rows(total %>% mutate(across(contains('monthly'), as.character))) %>%
arrange(prod_date)
c
left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = as.character(str_glue("{monthly_oil} ({oil_percent}%)")),
monthly_gas = as.character(str_glue("{monthly_gas} ({gas_percent}%)")),
monthly_oil_10km = as.character(str_glue("{monthly_oil_10km} ({oil_percent_10km}%)")),
monthly_gas_10km = as.character(str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))) %>%
select(-ends_with("_total"), -contains('_percent'))
left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = as.character(str_glue("{monthly_oil} ({oil_percent}%)")),
monthly_gas = as.character(str_glue("{monthly_gas} ({gas_percent}%)")),
monthly_oil_10km = as.character(str_glue("{monthly_oil_10km} ({oil_percent_10km}%)")),
monthly_gas_10km = as.character(str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))) %>%
select(-ends_with("_total"), -contains('_percent'))
left_join(a, b)
a <- wells_prod %>%
group_by(prod_date, type) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional')) %>%
bind_rows(
)
b <- wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date, type) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil_10km = sum(monthly_oil, na.rm = T),
monthly_gas_10km = sum(monthly_gas, na.rm = T)
) %>%
mutate(type = if_else(type == 1, 'Conventional', 'Unconventional')) %>%
bind_rows(
)
total <- left_join(
wells_prod %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil = sum(monthly_oil, na.rm = T),
monthly_gas = sum(monthly_gas, na.rm = T)
)
,
wells_prod %>%
filter(distToLovi <= 10) %>%
group_by(prod_date) %>%
filter(prod_date >= '2023-05-01', prod_date <= '2024-06-01') %>%
summarize(
monthly_oil_10km = sum(monthly_oil, na.rm = T),
monthly_gas_10km = sum(monthly_gas, na.rm = T)
)
) %>%
mutate(type = 'Total') %>%
relocate(prod_date, type)
total
c <- left_join(a, b) %>%
left_join(total, join_by(prod_date), suffix = c("", "_total")) %>%
mutate(oil_percent = round(monthly_oil/monthly_oil_total*100, 2),
gas_percent = round(monthly_gas/monthly_gas_total*100, 2),
oil_percent_10km = round(monthly_oil_10km/monthly_oil_10km_total*100, 2),
gas_percent_10km = round(monthly_gas_10km/monthly_gas_10km_total*100, 2)) %>%
mutate(monthly_oil = as.character(str_glue("{monthly_oil} ({oil_percent}%)")),
monthly_gas = as.character(str_glue("{monthly_gas} ({gas_percent}%)")),
monthly_oil_10km = as.character(str_glue("{monthly_oil_10km} ({oil_percent_10km}%)")),
monthly_gas_10km = as.character(str_glue("{monthly_gas_10km} ({gas_percent_10km}%)"))) %>%
select(-ends_with("_total"), -contains('_percent')) %>%
bind_rows(total %>% mutate(across(contains('monthly'), as.character))) %>%
arrange(prod_date)
c
